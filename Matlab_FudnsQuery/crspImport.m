%% Automate Importing Data by Generating Code Using the Database Explorer App
% This code reproduces the data obtained using the Database Explorer app by
% connecting to a database, executing a SQL query, and importing data into the
% MATLAB(R) workspace. To use this code, add the password for connecting to the
% database in the database command.

% Auto-generated by MATLAB Version 9.9 (R2020b) and Database Toolbox Version 10.0 on 25-Jan-2021 11:15:56

%% Make connection to database
conn = database('DB','USER','PSWD');

%Set query to execute on the database
query = ['SELECT DISTINCT crsp_fundno, ' ...
    '	summary_period2, ' ...
    '	caldt, ' ...
    '	tna_latest, ' ...
    '	dead_flag, ' ...
    '	mgmt_fee, ' ...
    '   crsp_obj_cd, ' ... 
    '   si_obj_cd, ' ...
    '   lipper_class, ' ... 
    '   lipper_obj_cd, ' ...
    '	index_fund_flag, ' ...
    '	first_offer_dt ' ...
    'FROM wrds.crsp.fund_summary2 ' ...
    'WHERE accrual_fund = ''N'' ' ...
    '	AND open_to_inv = ''Y'' ' ...
    '	AND (crsp_obj_cd = ''EDYB'' ' ...
    '	OR crsp_obj_cd = ''EDYG'' ) ' ...
    '	AND (first_offer_dt >= ''1975-01-01'' ' ...
    '	AND first_offer_dt <= ''2020-12-31'') ' ...
    'ORDER BY crsp_fundno ASC, ' ...
    '	first_offer_dt ASC'];

%% Execute query and fetch results
crspImport = fetch(conn,query);

%% Close connection to database
close(conn)

%% Clear variables
clear conn query